<HTML>

<HEAD>
<TITLE>コンピュータ室［私のパソコンユーザ歴:1995年］</TITLE>
</HEAD>

<BODY bgcolor=#ffeeff LINK=#ff0000 VLINK=#ff00ad>

<center>
<table width=98%><tr><td bgcolor=#ffffff><center><a href="1994.htm"><b>前年</b></a></center></td>
<td bgcolor=#ff00ad><center><FONT COLOR=#ffffff><B>１９９５年の話題</B></FONT></td>
<td bgcolor=#ffffff><center><a href="1996.htm"><b>次年</b></a></center></td></tr></table>

<br>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>グラフィックデータ移行作戦</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　ほとんど使っていなかったPC-9801RX21を実家に持っていった。そして、X1turboIIと並べて置くことになった。せっかく並べて置くのだからシリアルケーブルで接続して通信できるようにしようと思った。目的は、グラフィックデータの転送。<br>
　X1とPC-9801ではフロッピーディスクのフォーマットが異なるのでそのまま読み込ませることは出来ない。X1turboIIも結構古くなってきているのでいつ壊れてもおかしくないだろう。そして、X1用の保存してあったフロッピーディスクにはたくさんの自作グラフィックデータやビデオ取り込みしたグラフィックがある。この、グラフィックをWindows環境へ移行することにしたのだ。<br>
　過去のマシンのデータを最新のWindows環境へ移行するのだから結構大変だった。シリアルポートはRS-232C規格なのでX1とPC-9801で通信させることが出来る。X1turbo用にはグラフィック情報の送信プログラムを、PC-9801用にはグラフィック情報の受信プログラムをそれぞれBASICで作成した。<br>
<br>
　移行作戦は以下の通り、<br>
　　１．「turbo Z's STAFF」のSTX形式ファイルをBASIC上でロードし、画面に表示させる。(X1)<br>
　　２．自作の受信プログラムを起動。(PC-9801)<br>
　　３．自作の送信プログラムを起動。(X1)<br>
　　４．転送が終わったら、ベタファイル形式でセーブ。(PC-9801)<br>
<br>
転送は画面に表示されているグラフィックを1dotづつカラーコードで送信、受信側ではカラーコードを元に1dotづつグラフィックを描画するという方式。（実際には高速化のため数dot分まとめて転送している。）これで、１枚のグラフィックを転送するのに30分から40分かかった。<br>
<br>
　次は、PC-9801のBASIC形式からWindows形式への移行だ。これはPC-9801FA2上で行った。<br>
　　１．MS-DOS付属のコンバートユーティリティでN88-BASICフォーマットのファイルをMS-DOS形式に変換。<br>
　　２．「Z's STAFF KiD 98」でベタファイル形式をロード。そして、ZIM形式でセーブ。<br>
　　３．「SUPER KiD for Windows」でZIM形式をロード。そして、BMP形式でセーブ。<br>
<br>
以上のようにして、X1turboのグラフィックをWindowsへ移行することが出来た。<br>
</td></tr></table><br>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>さらにリアルなサウンドへ</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　初代GS規格音源のCM-500は「本物の音」で満足していたが、さらに上が現れた。SC-88だ。友人が買ったので聴かせてもらったところ、CM-500は「やっぱり嘘の音だった！」と思ってしまった。<br>
　すぐに買いたいと思ったのだがお金の都合もある。そこで、CM-500と以前使っていたCM-32Lを中古に出して買い換えることにした。ところで、古いCM-32Lをまだ持っていたのはわけがある。「ミュージ郎Jr.」というセットで買っていたのでMIDIインターフェイスが必要だったからだ。（音源だけで売れない。）CM-32Lを売るためにはMIDIインターフェイスも売らなければならない。<br>
　幸い、SC-88はシリアルポートで接続できるので専用のシリアルケーブルを買えば、MIDIインターフェイスがなくても使える。さっそく、CM-500と「ミュージ郎Jr.」とついでにドットプリンタを中古で売り、SC-88を買った。１万円ぐらいの出費で新しい音源が買えた。<br>
<br>
　シリアルインターフェイス接続にしてしまったため、DOSのゲームソフトでMIDIを鳴らすことが出来なくなってしまった。Windowsでは問題ないが。<br>
</td></tr></table><br>
</center>
<a name="x1turbo2">
　<a href="x1turbo2.htm#1995"><img src="../../penta4.gif" align=absmiddle border=0>この時点でのX1turboIIスペック</a><br>
<a name="pc9801rx21">
　<a href="pc9801rx21.htm#1995"><img src="../../penta4.gif" align=absmiddle border=0>この時点でのPC-9801RX21スペック</a><br>
<a name="pc9801fa2">
　<a href="pc9801fa2.htm#1995"><img src="../../penta4.gif" align=absmiddle border=0>この時点でのPC-9801FA2スペック</a><br>
<br>
<center>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>４台目パソコン32bit Pentiumパソコンを買う</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　PC-9801FA2に４倍速CPUアクセラレータを入れて当分使えると思っていたが、Windowsアプリケーションの高機能化は凄まじくマシンパワーが足りなくなってきた。スワップが多いので、メモリの増設をすればまだ何とかなるかもしれないが、もう増設できない。そして次世代OSであるWindows95の発売も間近に迫ってきた。今のままではWindows95に対応させることは不可能だろう。<br>
　ということで、次に買うパソコンの検討に入った。Windowsの普及によりPC-9801である必要性はなくなっていた。Windowsの普及がAT互換機の普及を促進したようなもので一時期は周りの人からPC-9801シリーズを買うことが時代遅れのように見られることもあった。NECもそろそろAT互換機に乗り換えるんじゃないかという感じだったし。<br>
<br>
　そして、PC-9801シリーズをやめてAT互換機を買うことを前提に検討を進めた。最低条件はCPUがPentiumでメモリが16MBytes以上標準搭載であること。IBMは当時Pentiumマシンを出していなかったのでまず除外。Fujitsuは比較的安くていいが、性能がいまいち満足できそうもなかった。Compaqあたりが値段的にも性能的にもいいかなと思っていた。しかし、PC-9801用の周辺機器が使えないのでSCSIインターフェイスやサウンドボードなどを買わなければならないので初期投資が大きい。<br>
　しかし、NECが重大発表、「PC-9801はやめない。理由はWindowsの普及によりPC-9801とAT互換機の差が縮まり、やめる必要がないから。」ということ。そして、Windows95に完全対応する新MATE-Xシリーズを発表。性能的にはAT互換機に引けを取らなくなっていた。<br>
<br>
　NECが今後の98サポートを表明したのなら、安心してPC-9801シリーズを買うことが出来る。周辺機器も従来のものがそのまま使えるので初期投資が少なくて済むし。Windows95への無料バージョンアップサービスも始まったので、PC-9821Xa10/C4を買うことにした。買った時点ではこのPentium 100MHz機が最上位機種だった。買った直後に120MHz機が出たが大した差がないので別に気にしない。（ベースクロックは100MHz機の方が速いし。）<br>
　外付けのハードディスクを買ったときに付いてきたCバス用のSCSIインターフェイスボードが役に立つときが来た。しかし、ハードディスクをちゃんと認識してくれなかった。デフォルトのバスマスタ転送モードをFIFO転送モードにしたらちゃんと使えた。PCIバスのある機種ではCバス用SCSIインターフェイスボードでバスマスタ転送が出来ないらしい。<br>
</td></tr></table><br>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>OSも32bit化、Windows95を導入</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　Windows95が発売され、無料バージョンアップのCD-ROMが送られてきた。Windows95はWindows3.1と違い、プラグ＆プレイで周辺機器を認識してくれるのでセットアップを全部自動でしてくれる。<br>
　しかし、セットアップ途中のハードウェアのチェックの所で固まってしまった。一旦電源を切り修復セットアップをするという指示通りにやる。すると、さっき固まった所をスキップして先に進んだ。凄い時間がかかってセットアップ完了。<br>
　操作性はWindows3.1とだいぶ変わったが、MacOSに似た感じになった。（会社でMacを使っていたのでそれほど違和感はない。）<br>
<br>
　さて、一つ問題が起きた。シリアルポート#2(COM2)が使えないのである。PC-9821Xa10/C4になってシリアルポートが２つになったのでモデムとSC-88でそれぞれ使おうと思ったのだが、接続した機器の電源を入れるだけで「ピポッ」という音と共にパソコンのリセットがかかるのだ。モデムをつないでもSC-88をつないでも同じ。Windows3.1の時はそんな事なかったのに。<br>
　もしWindows95のバグだとしたらNIFTY-SERVEの会議室等で話題になっていそうだが、同じ様な現象は報告されていなかった。もしかしたらWindows95のセットアップがうまく行われていない可能性がある。一回固まって修復セットアップしたし。<br>
　セットアップをやり直すことにした。全部消して最初からやり直す。すると、やはりハードウェアのチェックで固まるのだ。固まる原因を特定するために拡張ボード類を全てはずした状態でやり直し。すると問題なくセットアップできた。<br>
　今度は１つづつボードを入れて、ハードウェアウィザードで認識させていく。すると、「Video Charger 98」を入れて認識させたら固まってしまった。全ての原因はこれだった。Windows95のセットアップは「Video Charger 98」を入れない状態で行い、最後にボードをセットして手動でドライバをインストールすれば問題なく使える。ちゃんとCOM2も使えるようになった。<br>
　「Video Charger 98」が正しく認識できないせいで、COM2が使えなくなるのは謎だが、パソコンのトラブルというのは一見関係ないことが絡み合って起きていることがあるという証拠だな。<br>
</td></tr></table><br>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>Windows95にあわせて周辺機器もパワーアップ</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　Windows3.1では16MBytesのメモリは十分すぎる感じだったが、Windows95になったら急に足りない感じになった。16MBytes増設するか32MBytes増設するか悩むところだが、SIMMスロットが4つしかなく、すでに8MBytes×2で埋まっているので残りが2つ。Pentiumマシンは2枚1組で入れないといけないので8MBytes×2にするか、16MBytes×2にするか迷ってしまう。<br>
　将来性を考えて32MBytes増設することにした。この頃は12万円もした。（１，２ヶ月後に、急にメモリの価格が暴落した。）もうちょっと待っていれば32MBytes×2が余裕で買えたが仕方がないな。<br>
　メモリが48MBytesになった効果は大きく、かなり快適になった。<br>
<br>
　次は、SCSIインターフェイスをPCIバス用に交換する。32bit OSにあわせて高速化を図る目的もあるが、本当の目的はCバススロットを１つ空けるためだった。<br>
　この頃、PC-9821で使えるPCI用のSCSIインターフェイスはNEC純正とAdaptec製しかなかった。どちらも値段が大して変わらなかったので、NEC純正を買ったが、箱を開けてみると中身はAdaptec製だった。つまり、OEM品の全く同じものだったのだ。SCSIでは業界標準ともいえるAdaptec製だから性能的にも問題ない。（スキャナやCD-Rにも対応できる。）<br>
</td></tr></table><br>

<table width=98%><tr><td bgcolor=#ff00ad>
<font color="#ffffff"><b>ゲーム機のソフトを作れるぞ</b></font>
</td></tr><tr><td bgcolor=#ffffff>
　SCSIインターフェイスをPCIバス用に交換してCバススロットを空けたのは、PC-FXGAを入れるためだ。PC-FXGAとはNECの32bitテレビゲーム機PC-FXに3Dポリゴン機能とパソコンからの制御機能を追加し、ボード化したもの。これを入れれば、PC-FXのソフトをプレイできるだけでなく、自分でソフトを作ることもできる。<br>
　普通、テレビゲーム機のソフト開発をするためにはハードメーカとサードパーティ契約をし、高価な開発機材を購入しなければならないが、一般の人でも手軽に低価格でソフト開発できるのだ。<br>
<br>
　開発はC言語で行うのだが、パソコンソフトのプログラミングと全く違うので難しい、printf等の基本的な入出力関数すら存在していなくて、独自の関数がたくさんある。パソコンとはハードウェア構成が全く違うからだ。今までパソコンでやってきた知識では作ることが出来ない。サンプルプログラムを参考にちょっとしたプログラムをやっと作ることが出来た。（ダウンロードコーナで公開中。）<br>
　ドキュメントファイル（マニュアル）にPC-FXのハードウェアやライブラリ関数がかなり詳細に出ているが、理解するのは大変だ。<br>
</td></tr></table><br>
</center>
<a name="pc9801fa2_2">
　<a href="pc9801fa2.htm#1995_2"><img src="../../penta4.gif" align=absmiddle border=0>この時点でのPC-9801FA2スペック</a><br>
<a name="pc9821xa10">
　<a href="pc9821xa10.htm#1995"><img src="../../penta4.gif" align=absmiddle border=0>この時点でのPC-9821Xa10/C4スペック</a><br>
<br>
<center>

<hr><br>

<a href="1994.htm"><img src="../../back.gif" align=absmiddle border=0>1994年へ</a>　
<A HREF="index.htm"><img src="../../return.gif" align=absmiddle border=0></A>　
<a href="1996.htm">1996年へ<img src="../../next.gif" align=absmiddle border=0></a><BR><br>
<IMG SRC="../../copyright.gif" ALT="Copyright (C) 1997-2001 by Yoshinori Adachi">
</CENTER>

</BODY>
</HTML>
